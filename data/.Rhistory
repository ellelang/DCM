R = 50,
panel = TRUE,
fixed = c(TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE),
start = start,
method = "BHHH",
iterlim = 100)
wtp.gmnl(nlogit_rpl.gmnl, wrt = "Payment")
wtp.gmnl(mnl.gmnl, wrt = "Payment")
mnl.gmnl <- gmnl(Y ~  Payment + Wetland + Covercrop + NuMgt, data = dataset1, model = "mnl")
summary(mnl.gmnl)
wtp.gmnl(mnl.gmnl, wrt = "Payment")
summary(nlogit_rpl.gmnl)
rpl.gmnl_sdpay <- gmnl(Y ~ pay_stz + negWetland + Covercrop|
dem_2018  +  foodcost +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
pay_stz = c("incfar_5","costlive")),
correlation = TRUE)
##################
dataset1$pay_stz <- (dataset1$Payment - mean(dataset1$Payment))/sd(dataset1$Payment)
set.seed(1000)
rpl.gmnl_sdpay <- gmnl(Y ~ pay_stz + negWetland + Covercrop|
dem_2018  +  foodcost +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
pay_stz = c("incfar_5","costlive")),
correlation = TRUE)
dataset1$pay_stz <- (dataset1$Payment - mean(dataset1$Payment))/sd(dataset1$Payment)
set.seed(1000)
rpl.gmnl_sdpay <- gmnl(Y ~ pay_stz + negWetland + Covercrop|
dem_2018  +  foodcost +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n",  pay_stz = "ln"),
mvar = list(Covercrop = "scaleimplakes",
pay_stz = c("incfar_5","costlive")),
correlation = TRUE)
summary(rpl.gmnl_sdpay)
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  +  foodcost +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 50,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = TRUE)
summary(rpl.gmnl)
nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop + dem_2018 + incfar |
1|
0|
scaleimplakes,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
correlation = TRUE)
summary(nlogit_rpl.gmnl)
nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop |
dem_2018 + incfar |
0|
scaleimplakes,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
correlation = TRUE)
summary(nlogit_rpl.gmnl)
set.seed(123)
dataset1$scaleimplakes <- dataset1$implakes / 1000
dataset1$negWetland <- -1 * dataset1$Wetland
nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop |
dem_2018 + incfar |
0|
scaleimplakes,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
correlation = FALSE)
summary(nlogit_rpl.gmnl)
nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop |
dem_2018 + incfar |
0|
scaleimplakes,
data = dataset1,
model = 'mixl',
R = 60,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
correlation = FALSE)
summary(nlogit_rpl.gmnl)
nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop |
dem_2018 + incfar |
0|
scaleimplakes,
data = dataset1,
model = 'mixl',
R = 60,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
correlation = TRUE)
summary(nlogit_rpl.gmnl)
nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop |
dem_2018 + incfar |
0|
scaleimplakes,
data = dataset1,
model = 'mixl',
R = 60,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
correlation = FALSE)
summary(nlogit_rpl.gmnl)
nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop |
dem_2018 + incfar |
0|
scaleimplakes,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
correlation = FALSE)
summary(nlogit_rpl.gmnl)
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  +  foodcost +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 50,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = FALSE)
summary(rpl.gmnl)
# Why Am I getting NAs with gmnl? https://rpubs.com/msarrias1986/316032
pay_sdz <- (dataset1$Payment - mean(dataset1$Payment))/sd(dataset1$Payment)
rpl.gmnl_sdpay <- gmnl(Y ~ pay_sdz + negWetland + Covercrop|
dem_2018  +  foodcost +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 50,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", pay_sdz = "ln"),
mvar = list(Covercrop = "scaleimplakes",
pay_sdz = c("incfar_5","costlive")),
correlation = FALSE)
summary(rpl.gmnl_sdpay)
start <- c(1,1,1,1,1,1,1,1)
wtp_nlogit_rpl.gmnl <- gmnl(Y ~ Payment + Wetland + Covercrop + dem_2018 + incfar + scaleimplakes |
0 |
0 |
0 |
1,
data = wtp_dataset1,
model = 'smnl',
R = 50,
panel = TRUE,
fixed = c(TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE),
start = start,
method = "BHHH",
iterlim = 100)
start <- c(1,1,1,1,1,1,1,1)
wtp_nlogit_rpl.gmnl <- gmnl(Y ~ Payment + Wetland + Covercrop + dem_2018 + incfar + scaleimplakes |
0 |
0 |
0 |
1,
data = wtp_dataset1,
model = 'smnl',
R = 50,
panel = TRUE,
fixed = c(TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE),
start = start,
iterlim = 100)
start <- c(0,0.1,0.1,0,0.1,0.1,0.1,0.1)
wtp_nlogit_rpl.gmnl <- gmnl(Y ~ Payment + Wetland + Covercrop + dem_2018 + incfar + scaleimplakes |
0 |
0 |
0 |
1,
data = wtp_dataset1,
model = 'smnl',
R = 50,
panel = TRUE,
fixed = c(TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE),
start = start,
iterlim = 100)
summary(wtp_nlogit_rpl.gmnl)
start <- c(0,0.1,0.1,0,0.1,0.1,0.1,0.1)
wtp_nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop |
dem_2018 + incfar |
0 |
scaleimplakes |
1,
data = wtp_dataset1,
model = 'smnl',
R = 50,
panel = TRUE,
fixed = c(TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE),
start = start,
iterlim = 100)
wtp_dataset1 $negWetland <- -1 * wtp_dataset1 $Wetland
start <- c(0,0.1,0.1,0,0.1,0.1,0.1,0.1)
wtp_nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop |
dem_2018 + incfar |
0 |
scaleimplakes |
1,
data = wtp_dataset1,
model = 'smnl',
R = 50,
panel = TRUE,
fixed = c(TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE),
start = start,
iterlim = 100)
start <- c(0,0.1,0.1,0,0.1,0.1,0.1,0.1)
wtp_nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop |
dem_2018 + incfar |
0 |
scaleimplakes |
1,
data = wtp_dataset1,
model = 'smnl',
R = 50,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
fixed = c(TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE),
start = start,
iterlim = 100)
start <- c(0,0.1,0.1,0,0.1,0.1,0.1,0.1)
wtp_nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop |
dem_2018 + incfar |
0 |
scaleimplakes |
1,
data = wtp_dataset1,
model = 'gmnl',
R = 50,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
fixed = c(TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE),
start = start,
iterlim = 100)
summary(wtp_nlogit_rpl.gmnl)
start <- c(0,0.1,0.1,0,0.1,0.1,0.1,0.1)
wtp_nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop |
dem_2018 + incfar |
0 |
scaleimplakes |
1,
data = wtp_dataset1,
model = 'gmnl',
R = 50,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
fixed = c(TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE),
start = start,
iterlim = 100)
start2 <- c(0.1, coef(wtp_nlogit_rpl.gmnl), rep(0.1,5),0.2, 0 )
wtp_nlogit_rpl.gmnl_1 <- gmnl(Y ~ Payment + negWetland + Covercrop |
dem_2018 + incfar |
0 |
scaleimplakes |
1,
data = wtp_dataset1,
model = 'gmnl',
R = 50,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
fixed = c(TRUE,rep(FALSE,12),TRUE),
start = start2,
iterlim = 100)
start2 <- c(0.1, coef(wtp_nlogit_rpl.gmnl), rep(0.1,5),0.2, 0 )
wtp_nlogit_rpl.gmnl_1 <- gmnl(Y ~ Payment + negWetland + Covercrop + dem_2018 + incfar + scaleimplakes   |
0 |
0 |
0|
1,
data = wtp_dataset1,
model = 'gmnl',
R = 50,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
fixed = c(TRUE,rep(FALSE,12),TRUE),
start = start2,
iterlim = 100)
summary(wtp_nlogit_rpl.gmnl)
start2 <- c(0.1, coef(wtp_nlogit_rpl.gmnl), rep(0.1,5),0.2, 0 )
wtp_nlogit_rpl.gmnl_1 <- gmnl(Y ~ Payment + negWetland + Covercrop + dem_2018 + incfar + scaleimplakes   |
0 |
0 |
0|
1,
data = wtp_dataset1,
model = 'gmnl',
R = 50,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
fixed = c(TRUE,rep(FALSE,12),TRUE),
start = start2,
iterlim = 100)
set.seed(123)
normals <- rnorm(10000, 0, 1)
plot(density(normals))
beta_price <- exp(-6.41375 + 2.96762 * normals)
mean(beta_price) # Why is it so different than the theoretical expected value?
theoretical_mean <- exp(-6.41375 + 2.96762^2 / 2)
plot(density(beta_price))
beta_wetlands <- - exp(-1.35251 + 3.00529 * normals)
mWTA_wetlands <- - beta_wetlands / beta_price
plot(density(mWTA_wetlands))
wtp.gmnl(nlogit_rpl.gmnl, wrt = "Payment")
mWTA_CC <- - beta_CC / beta_price
plot(density(mWTA_CC))
beta_CC <- (-0.34960 + 0.06189*1.837) + 1.29781 * normals
plot(density(beta_CC))
mWTA_CC <- - beta_CC / beta_price
plot(density(mWTA_CC))
density(mWTA_CC)
rm(list = ls())
library(mlogit)
library(gmnl)
library(tidyverse)
library(fastDummies)
setwd("C:/Users/langzx/Desktop/github/DCM/data")
dataset <- read.csv (file = "wta_observables12032018.csv",header = TRUE)
View(dataset)
dataset0 <- read.csv (file = "wta_observables12032018.csv",header = TRUE)
dataset <- select(dataset0, -c("id","ChoiceSet","alti","task"))
View(dataset)
View(dataset0)
colnames(dataset0)
dataset <- select(dataset0, -c("id","ChoiceSet","alti","task","incfar_NA","areaf_NA"))
rm(list = ls())
library(mlogit)
library(gmnl)
library(tidyverse)
library(fastDummies)
setwd("C:/Users/langzx/Desktop/github/DCM/data")
dataset0 <- read.csv (file = "wta_observables11192018.csv",header = TRUE)
colnames(dataset0)
dataset <- select(dataset0, -c("id","ChoiceSet","alti","task","income_NA","areaf_NA"))
betas <- read.table("beta.dat", header = FALSE, sep = "\t", quote=FALSE)
betas <- read.table("beta.dat", header = FALSE, sep = "\t", quote=FALSE)
betas <- read.table("beta.dat", header = FALSE, sep = "\t")
View(betas)
betas <- read.table("beta.dat", header = FALSE, sep = "\t", header = TRUE)
betas <- read.table("beta.dat", header = FALSE, sep = "\t", header = TRUE)
betas <- read.table("beta.dat", sep = "\t", header = TRUE)
View(betas)
varcov <- read.table("varcov.dat", sep = "\t", header = FALSE)
View(dataset)
var_names <- betas$Names
var_names
#################
colnames(dataset0)
dataset <- read.csv (file = "wta_observables11192018.csv",header = TRUE)
dim(datast)
dim(dataset)
##interactions
lakescale <- dataset$implakes/1000
wetland <- - 1*dataset0$Wetland
pay <- dataset$Payment
cc <- dataset$Covercrop
nm <-dataset$NuMgt
asc <- rep(1,dim(dataset)[1])
dems18 <- dataset$dem_2018
costtax <- dataset$taxcost
##dummyvariables
inc1 <- dataset$income_1
inc2 <- dataset$income_2
inc3 <- dataset$income_3
inc4 <- dataset$income_4
inc5 <- dataset$income_5
inc6 <- dataset$income_6
inc7 <- dataset$income_7
farm1 <- dataset$areaf_1
farm2 <- dataset$areaf_2
farm3 <- dataset$areaf_3
farm4 <- dataset$areaf_4
##interactions
lakescale <- dataset$implakes/1000
wldlake <- wetland * lakescale
wldinc <- wetland * inc7
paylake <- pay * lakescale
payinc <- pay * inc7
cclake <- cc * lakescale
ccdinc <- cc * inc7
nmlake <-nm * lakescale
nminc <- nm * inc7
varcov <- read.table("varcov.dat", sep = "\t", header = FALSE)
View(varcov)
betas <- read.table("beta.dat", sep = "\t", header = TRUE)
varcov <- read.table("varcov.dat", sep = "\t", header = FALSE)
View(betas)
View(varcov)
########Construct X matrix
var_names <- betas$Names
var_names
paste(shQuote(var_names), collapse=",")
cat(paste(shQuote(var_names, type="cmd"), collapse=", "))
#########
Xmatrix <- cbind (cat(paste(shQuote(var_names, type="cmd"), collapse=", ")))
Xmatrix
#########
variables <- c(cat(paste(shQuote(var_names, type="cmd"), collapse=", ")))
variables
#########
cat(paste(shQuote(var_names, type="cmd"), collapse=", "))
Xmatrix <- cbind ("wetland", "pay", "cc", "nm", "asc",
"dems18", "costtax", "inc1", "inc2",
"inc3", "inc4", "inc5", "inc6", "farm1",
"farm2", "farm3", "farm4", "payinc", "cclake")
Xmatrix
cat(paste(shQuote(var_names), collapse=", "))
cat(paste(var_names, collapse=", "))
Xmatrix <- cbind (wetland, pay, cc, nm, asc, dems18,
costtax, inc1, inc2, inc3, inc4, inc5,
inc6, farm1, farm2, farm3, farm4, payinc, cclake)
Xmatrix
n <- dim(dataset)[1]
k <- length(var_names)
n <- dim(dataset)[1]
n
k
Xmatrix <- as.matrix(cbind (wetland, pay, cc, nm, asc, dems18,
costtax, inc1, inc2, inc3, inc4, inc5,
inc6, farm1, farm2, farm3, farm4, payinc, cclake),
ncol = k, nrow = n)
Xmatrix
X_subset <- Xmatrix[1:100,]
dataset0 <- read.csv (file = "wholeCEscio_dataset_envinfo_1119.csv",header = TRUE)
rotation <- dataset0$primaryrotation
summary(rotation)
head(rotation)
max(rotation)
rotation <- as,numeric(dataset0$primaryrotation)
rotation <- as.numeric(dataset0$primaryrotation)
summary(rotation)
max(rotation)
min(rotation)
dataset <- read.csv (file = "wholeCEscio_dataset_countyinfo_1116.csv",header = TRUE)
rm(list = ls())
setwd("C:/Users/langzx/Desktop/github/DCM/data")
dataset <- read.csv (file = "wholeCEscio_dataset_envinfo_1119.csv",header = TRUE)
county <- dataset$County_resident
unique(county)
cat(paste(unique(county), collapse=", "))
county <- c(Hennepin, Watonwan, Yellow Medicine, Brown, Blue Earth, Cottonwood, Todd, Le Sueur, Douglas, Swift, Redwood, Otter Tail, Grant, Faribault, Stevens, Murray, Waseca, Lyon, Sibley, Freeborn, Lincoln, Kandiyohi, Carver, Lac Qui Parle, Traverse, Dakota, Rice, Renville, McLeod, Nicollet, Chippewa, Martin, Goodhue, Pope, Jackson, Meeker, Pipestone, Nobles, Wabasha, Steele, Big Stone, NA, Washington, Anoka, Sherburne)
cat(paste(shQuote(unique(county), type="cmd"), collapse=", "))
county_u <- c (countyname)
countyname <- cat(paste(shQuote(unique(county), type="cmd"), collapse=", "))
county_u <- c ("Hennepin", "Watonwan", "Yellow Medicine", "Brown", "Blue Earth", "Cottonwood", "Todd", "Le Sueur", "Douglas", "Swift", "Redwood", "Otter Tail", "Grant", "Faribault", "Stevens", "Murray", "Waseca", "Lyon", "Sibley", "Freeborn", "Lincoln", "Kandiyohi", "Carver", "Lac Qui Parle", "Traverse", "Dakota", "Rice", "Renville", "McLeod", "Nicollet", "Chippewa", "Martin", "Goodhue", "Pope", "Jackson", "Meeker", "Pipestone", "Nobles", "Wabasha", "Steele", "Big Stone", "NA", "Washington", "Anoka", "Sherburne")
county_u
county_u <- c ("Hennepin", "Watonwan", "Yellow Medicine", "Brown", "Blue Earth", "Cottonwood", "Todd", "Le Sueur", "Douglas", "Swift", "Redwood", "Otter Tail", "Grant", "Faribault", "Stevens", "Murray", "Waseca", "Lyon", "Sibley", "Freeborn", "Lincoln", "Kandiyohi", "Carver", "Lac Qui Parle", "Traverse", "Dakota", "Rice", "Renville", "McLeod", "Nicollet", "Chippewa", "Martin", "Goodhue", "Pope", "Jackson", "Meeker", "Pipestone", "Nobles", "Wabasha", "Steele", "Big Stone", "NA", "Washington", "Anoka", "Sherburne")
county_u
write.table (x = county_u, file = "county.dat", sep = "\t",quote=FALSE, row.names = FALSE)
