<<<<<<< HEAD
=======
install.packages("mlogit")
install.packages("gmnl")
install.packages("tidyverse")
install.packages("fastDummies")
>>>>>>> 2f77b4a5aee553b1ba1a86704d6c8149a8494c56
rm(list = ls())
library(mlogit)
library(gmnl)
library(tidyverse)
library(fastDummies)
setwd("C:/Users/langzx/Desktop/github/DCM/data")
dataset <- read.csv (file = "wta_observables11192018.csv",header = TRUE)
dim(dataset)
n <- dim(dataset)[1]
dataset$asc <- rep(1,n )
colnames(dataset)
<<<<<<< HEAD
betas <- read.table("beta.dat", sep = ",", header = TRUE)
varcov <- read.table("varcov.dat", sep = "\t", header = FALSE)
L <- t(chol(varcov))
dataset$lake1000 <- dataset$implakes/1000
=======
>>>>>>> 2f77b4a5aee553b1ba1a86704d6c8149a8494c56
betas <- read.table("beta.dat", sep = ",", header = TRUE)
varcov <- read.table("varcov.dat", sep = "\t", header = FALSE)
L <- t(chol(varcov))
L
sd <- read.table("sd.dat", sep = ",", header = TRUE)
betas$Names
sd
dat0 <- select (dataset, Wetland, Payment, Covercrop, NuMgt, asc,
dem_2018,taxcost,
income_1, income_2, income_3, income_4, income_5, income_6,
<<<<<<< HEAD
areaf_1, areaf_2, areaf_3, areaf_4, crp2018, lake1000)
dat1 <- sample_n(dat0, 1)
=======
areaf_1, areaf_2, areaf_3, areaf_4, crp2018, implakes )
dat1 <- sample_n(dat0, 1000)
>>>>>>> 2f77b4a5aee553b1ba1a86704d6c8149a8494c56
dat1
dat_m <- as.matrix(x = dat1, nrow = 1, ncol = 19)
dat_m
dat_m %*% betas$Betas
<<<<<<< HEAD
filter(betas, Names == "wetland")
filter(betas, Drink == "water")
betas[betas$Names=="wetland",]
betas$Betas[betas$Names=="wetland"]
betas$Betas[betas$Names=="pay"]
cc_rp <- betas$Betas[betas$Names=="cc"]
wld_rp <- betas$Betas[betas$Names=="nm"]
=======
new_beta <- t(L)%*% betas$Betas + betas$Betas
new_beta[3,]
normals <- rnorm(10, 0, 1)
new_beta2 <- c(0,0,0,0,new_beta[5:19])
#new_beta2_wld <- c(0,0,0,0,new_beta[5:19])
#new_beta2_wld
wta_wetland <- -((exp (new_beta[1,] + sd$sd[1] * normals)) + dat_m %*% new_beta2)/ new_beta_price
wta_wetland
!is.na(wta_wetland)
plot(density(na.omit(wta_wetland)))
setwd("C:/Users/langzx/Desktop/github/DCM/data")
dataset <- read.csv (file = "wta_observables11192018.csv",header = TRUE)
dim(dataset)
n <- dim(dataset)[1]
dataset$asc <- rep(1,n )
colnames(dataset)
>>>>>>> 2f77b4a5aee553b1ba1a86704d6c8149a8494c56
betas <- read.table("beta.dat", sep = ",", header = TRUE)
## Payment
pay_rp <- betas$Betas[betas$Names=="pay"]
## wetland
wld_rp <- betas$Betas[betas$Names=="wetland"]
## cc
cc_rp <- betas$Betas[betas$Names=="cc"]
## wetland
wld_rp <- betas$Betas[betas$Names=="nm"]
beta2 <- betas$Betas
beta2<- c(0,0,0,0,betas$Betas[5:18],0)
dat_m %*% beta2
n_draws <- 10000
wtp_wld <- (wld_rp * rexp(rate = 1, n = n_draws) + dat_m %*% beta2) / pay_rp * rexp(rate = 1, n = n_draws)
wtp_wld <- (wld_rp * rexp(rate = 1, n = n_draws) + as.vector(dat_m %*% beta2)) / pay_rp * rexp(rate = 1, n = n_draws)
mean(wtp_wld, na.rm = TRUE)
n_draws <- 10000
wtp_wld <- -(wld_rp * rexp(rate = 1, n = n_draws) + as.vector(dat_m %*% beta2)) / pay_rp * rexp(rate = 1, n = n_draws)
mean(wtp_wld, na.rm = TRUE)
plot(density(wtp_wld))
wtp_wld
wld_rp <- betas$Betas[betas$Names=="wetland"]
cc_rp <- betas$Betas[betas$Names=="cc"]
nm_rp <- betas$Betas[betas$Names=="nm"]
beta2<- c(0,0,0,0,betas$Betas[5:18],0)
dat_m %*% beta2
n_draws <- 10000
wtp_wld <- -(wld_rp * rexp(rate = 1, n = n_draws) + as.vector(dat_m %*% beta2)) / pay_rp * rexp(rate = 1, n = n_draws)
mean(wtp_wld, na.rm = TRUE)
plot(density(wtp_wld))
wtp_wld
wta_nm <- -(nm_rp * rexp(rate = 1, n = n_draws) + as.vector(dat_m %*% beta2)) / pay_rp * rexp(rate = 1, n = n_draws)
mean(wta_nm, na.rm = TRUE)
plot(density(wta_nm))
wta_nm
betas$Names
lake_rp <- betas$Betas[betas$Names=="cclake "]
dat_m
<<<<<<< HEAD
dim(dat_m)
dat_m$lake1000
dat_m[-1]
dat_m
dat_m[,-1]
dat_m[,19]
dat_m
wta_cc <- -((cc_rp + lake_rp * dat_m[,19] )* rexp(rate = 1, n = n_draws) + as.vector(dat_m %*% beta2)) / pay_rp * rexp(rate = 1, n = n_draws)
mean(wta_cc, na.rm = TRUE)
plot(density(wta_cc))
lake_rp * dat_m[,19]
lake_rp
lake_rp <- betas$Betas[betas$Names=="cclake"]
lake_rp
lake_rp
lake_rp * dat_m[,19]
wta_cc <- -((cc_rp + lake_rp * dat_m[,19] )* rexp(rate = 1, n = n_draws) + as.vector(dat_m %*% beta2)) / pay_rp * rexp(rate = 1, n = n_draws)
mean(wta_cc, na.rm = TRUE)
plot(density(wta_cc))
wta_cc
=======
dat_m %*% betas$Betas
new_beta <- t(L)%*% betas$Betas + betas$Betas
new_beta[3,]
normals <- rnorm(10, 0, 1)
new_beta2 <- c(0,0,0,0,new_beta[5:19])
wta_wetland <- -((exp (new_beta[1,] + sd$sd[1] * normals)) + dat_m %*% new_beta2)/ new_beta_price
new_beta_price <- new_beta[2,]
normals <- rnorm(10, 0, 1)
new_beta2 <- c(0,0,0,0,new_beta[5:19])
wta_wetland <- -((exp (new_beta[1,] + sd$sd[1] * normals)) + dat_m %*% new_beta2)/ new_beta_price
wta_wetland
!is.na(wta_wetland)
plot(density(na.omit(wta_wetland)))
mean(wta_wetland,rm.na = TRUE)
mean(na.omit(wta_wetland))
plot(density(na.omit(wta_wetland)))
wta_nm <- -((exp (new_beta[4,] + sd$sd[4] * normals)) + dat_m %*% new_beta2_wld)/ new_beta_price
wta_nm <- -((exp (new_beta[4,] + sd$sd[4] * normals)) + dat_m %*% new_beta2)/ new_beta_price
mean(na.omit(wta_nm))
plot(density(na.omit(wta_nm)))
wta_nm
plot(density(na.omit(wta_nm)))
>>>>>>> 2f77b4a5aee553b1ba1a86704d6c8149a8494c56
