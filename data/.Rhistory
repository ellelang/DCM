"impstrea", "implakes", "impwetl",
"streamr", "laker", "wetldr",
"imptotal", "childcar", "foodcost", "healthc",  "housecos",
"othercos"))
export_test_nlogit <- fastDummies::dummy_cols(export_test_nlogit, select_columns = c("incfar","areaf"))
write.csv(export_test_nlogit,file = "wta_observables12032018.csv", row.names = FALSE)
dataset <- read.csv (file = "wta_observables12032018.csv",header = TRUE)
dim(dataset)
colnames(dataset)
databestglm <- filter(dataset, dataset$alti == 1)
dim(databestglm)
databestglm <- rename(databestglm , y = Y )
databestglm <- dplyr::select(databestglm,-id,-ChoiceSet,-alti,-task)
databestglm <- drop_na(databestglm)
glm_data <- as.data.frame(databestglm)
bestglm(glm_data, IC = "BIC")
#BIC agrees with backward stepwise approach?
full_model<-glm(y ~ ., data = glm_data)
summary(full_model)
intercept_model <- glm(y ~ 1, data = glm_data)
#step(out, direction = "both", k=log(nrow(glm_data)))
stepAIC(full_model, direction = "backward")
stepAIC(intercept_model, direction = "forward",scope = list(upper = full_model,lower = intercept_model))
stepAIC(intercept_model, direction = "both",scope = list(upper = full_model,lower = intercept_model))
stepAIC(intercept_model, direction = "forward",scope = list(upper = full_model,lower = intercept_model))
#step(out, direction = "both", k=log(nrow(glm_data)))
stepAIC(full_model, direction = "backward")
setwd("C:/Users/langzx/Desktop/github/DCM/data")
rm(list = ls())
library(mlogit)
library(gmnl)
library(tidyverse)
library(fastDummies)
dim(dataset)
dataset <- read.csv (file = "wta_observables12032018.csv",header = TRUE)
dim(dataset)
colnames(dataset)
dataset$task
dataset1 <- mlogit.data(dataset, varying = 6:43, shape = "long",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
#simple MNL to serve as a check
mnl.gmnl <- gmnl(Y ~  Payment + Wetland + Covercrop + NuMgt, data = dataset1, model = "mnl")
summary(mnl.gmnl)
wtp.gmnl(mnl.gmnl, wrt = "Payment")
dataset1$Wetland <- dataset1$Wetland * -1
dataset1$implakes <- dataset1$implakes/1000
rpl.gmnl <- gmnl(choice ~ Payment + Wetland + Covercrop|
dem_2018  + costlive + childcar + foodcost + taxcost + healthc +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4 |
0|
implakes + costlive + incfar_5,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(Wetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "implakes",
Payment = c("costlive","incfar_5")),
correlation = TRUE)
rpl.gmnl <- gmnl(Y ~ Payment + Wetland + Covercrop|
dem_2018  + costlive + childcar + foodcost + taxcost + healthc +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4 |
0|
implakes + costlive + incfar_5,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(Wetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "implakes",
Payment = c("costlive","incfar_5")),
correlation = TRUE)
summary(rpl.gmnl)
dataset <- read.csv (file = "wta_observables12032018.csv",header = TRUE)
dataset1 <- mlogit.data(dataset, varying = 6:43, shape = "long",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
#simple MNL to serve as a check
implakes <- dataset1$implakes / 1000
#simple MNL to serve as a check
dataset1$implakes <- dataset1$implakes / 1000
dataset1$implakes
rpl.gmnl <- gmnl(Y ~ Payment + Wetland + Covercrop|
dem_2018  + costlive + childcar + foodcost + taxcost + healthc +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4 |
0|
implakes + costlive + incfar_5,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(Wetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "implakes",
Payment = c("costlive","incfar_5")),
correlation = TRUE)
#simple MNL to serve as a check
dataset1$scaleimplakes <- dataset1$implakes / 1000
dataset1$negWetland <- -1 * dataset1$Wetland
rm(list = ls())
library(mlogit)
library(gmnl)
library(tidyverse)
library(fastDummies)
setwd("C:/Users/langzx/Desktop/github/DCM/data")
dataset <- read.csv (file = "wta_observables12032018.csv",header = TRUE)
dim(dataset)
colnames(dataset)
dataset$task
implakes
dataset1 <- mlogit.data(dataset, varying = 6:43, shape = "long",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
#simple MNL to serve as a check
dataset1$scaleimplakes <- dataset1$implakes / 1000
dataset1$negWetland <- -1 * dataset1$Wetland
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + costlive + childcar + foodcost + taxcost + healthc +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4 |
0|
implakes + costlive + incfar_5,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("costlive","incfar_5")),
correlation = TRUE)
summary(rpl.gmnl)
#simple MNL to serve as a check
dataset1$scaleimplakes <- dataset1$implakes / 1000
dataset1$negWetland <- -1 * dataset1$Wetland
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + costlive + childcar + foodcost + taxcost + healthc +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4 |
0|
scaleimplakes + costlive + incfar_5,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("costlive","incfar_5")),
correlation = TRUE)
summary(rpl.gmnl)
rpl.gmnl <- gmnl(Y ~ Payment + Wetland + Covercrop|
dem_2018  + costlive + childcar + foodcost + taxcost + healthc +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4 |
0|
scaleimplakes + costlive + incfar_5,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(Wetland = "n", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("costlive","incfar_5")),
correlation = TRUE)
summary(rpl.gmnl)
rpl.gmnl <- gmnl(Y ~ Payment + Wetland + Covercrop|
dem_2018  + costlive + childcar + foodcost + taxcost + healthc +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4 |
0|
scaleimplakes + costlive + incfar_5,
data = dataset1,
model = 'mixl',
R = 10,
panel = TRUE,
ranp = c(Wetland = "n", Covercrop = "n", Payment = "n"),
mvar = list(Covercrop = "scaleimplakes",
Payment = "incfar_5"),
correlation = TRUE)
summary(rpl.gmnl)
rpl.gmnl <- gmnl(Y ~ Payment + Wetland + Covercrop|
dem_2018  + costlive + foodcost + taxcost +  laker +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5,
data = dataset1,
model = 'mixl',
R = 10,
panel = TRUE,
ranp = c(Wetland = "n", Covercrop = "n", Payment = "n"),
mvar = list(Covercrop = "scaleimplakes",
Payment = "incfar_5"),
correlation = TRUE)
summary(rpl.gmnl)
dataset1$scaleimplakes <- dataset1$implakes / 1000
dataset1$negWetland <- -1 * dataset1$Wetland
colnames(dataset)
nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  +
incfar_1 + incfar_2 + incfar_3 + incfar_4 |
0|
scaleimplakes,
data = dataset1,
model = 'mixl',
R = 10,
panel = TRUE,
ranp = c(Wetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
correlation = TRUE)
summary(rpl.gmnl)
nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + incfar|
0|
scaleimplakes,
data = dataset1,
model = 'mixl',
R = 10,
panel = TRUE,
ranp = c(Wetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
correlation = TRUE)
summary(rpl.gmnl)
nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + incfar|
0|
scaleimplakes,
data = dataset1,
model = 'mixl',
R = 10,
panel = TRUE,
ranp = c(Wetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
correlation = TRUE)
summary(nlogit_rpl.gmnl)
nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + incfar|
0|
scaleimplakes,
data = dataset1,
model = 'mixl',
R = 10,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
correlation = TRUE)
summary(nlogit_rpl.gmnl)
nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + incfar|
0|
scaleimplakes,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
correlation = TRUE)
summary(nlogit_rpl.gmnl)
summary(nlogit_rpl.gmnl)
nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
1 + dem_2018  + incfar|
0|
scaleimplakes,
data = dataset1,
model = 'mixl',
R = 30,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
correlation = TRUE)
summary(nlogit_rpl.gmnl)
set.seed(123)
nlogit_rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + incfar|
0|
scaleimplakes,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes"),
correlation = TRUE)
summary(nlogit_rpl.gmnl)
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + costlive + foodcost + taxcost +  laker +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = TRUE)
summary(rpl.gmnl)
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + costlive + foodcost + taxcost +  laker + scaleimplakes+
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + foodcost,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","foodcost")),
correlation = TRUE)
summary(rpl.gmnl)
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + costlive + foodcost + taxcost +  laker +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = TRUE)
summary(rpl.gmnl)
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + Wetland + Covercrop|
dem_2018  + costlive + foodcost + taxcost +  laker + scaleimplakes +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(Wetland = "n", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = TRUE)
summary(rpl.gmnl)
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + Wetland + Covercrop|
dem_2018  + costlive + foodcost + taxcost +  laker + scaleimplakes +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
#ranp = c(Wetland = "ln", Covercrop = "n", Payment = "ln"),
ranp = c(Wetland = "n", Covercrop = "n", Payment = "n"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = TRUE)
summary(rpl.gmnl)
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + Wetland + Covercrop|
dem_2018  + costlive + foodcost + taxcost +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
#ranp = c(Wetland = "ln", Covercrop = "n", Payment = "ln"),
ranp = c(Wetland = "n", Covercrop = "n", Payment = "n"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = TRUE)
summary(rpl.gmnl)
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + costlive + foodcost + taxcost +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
#ranp = c(Wetland = "ln", Covercrop = "n", Payment = "ln"),
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = TRUE)
summary(rpl.gmnl)
################  RPL
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + costlive + foodcost + taxcost +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 100,
panel = TRUE,
#ranp = c(Wetland = "ln", Covercrop = "n", Payment = "ln"),
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = TRUE)
summary(rpl.gmnl)
################  RPL
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + costlive + foodcost + taxcost +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = TRUE)
summary(rpl.gmnl)
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + costlive +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = TRUE)
summary(rpl.gmnl)
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  + costlive +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "n"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = TRUE)
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = TRUE)
summary(rpl.gmnl)
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  +  costlive +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = TRUE)
summary(rpl.gmnl)
set.seed(1000)
rpl.gmnl <- gmnl(Y ~ Payment + negWetland + Covercrop|
dem_2018  +  foodcost +
incfar_1 + incfar_2 + incfar_3 + incfar_4 +
areaf_1 + areaf_2 + areaf_3 + areaf_4  |
0|
scaleimplakes + incfar_5 + costlive,
data = dataset1,
model = 'mixl',
R = 20,
panel = TRUE,
ranp = c(negWetland = "ln", Covercrop = "n", Payment = "ln"),
mvar = list(Covercrop = "scaleimplakes",
Payment = c("incfar_5","costlive")),
correlation = TRUE)
summary(rpl.gmnl)
