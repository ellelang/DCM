dat1 <- sample_n(dataset, 10)
rm(list = ls())
library(mlogit)
library(gmnl)
library(tidyverse)
library(fastDummies)
setwd("C:/Users/langzx/Desktop/github/DCM/data")
dataset <- read.csv (file = "wta_observables11192018.csv",header = TRUE)
dim(dataset)
n <- dim(dataset)[1]
colnames(dataset)
betas <- read.table("beta.dat", sep = ",", header = TRUE)
varcov <- read.table("varcov.dat", sep = "\t", header = FALSE)
L <- t(chol(varcov))
L
sd <- read.table("sd.dat", sep = ",", header = TRUE)
betas
sd
set.seed(123)
dat1 <- sample_n(dataset, 10)
dat1
data.matrix(dat1, rownames.force = NA)
colnames(dataset)
betas
dataset$asc <- rep(1,n )
colnames(dataset)
dat0 <- select (dataset, Wetland, Payment, Covercrop, NuMgt, asc,
dem_2018,taxcost,
income_1, income_2, income_3, income_4, income_5, income_6,
areaf_1, areaf_2, areaf_3, areaf_4, crp2018, implakes )
dat1 <- sample_n(dat0, 10)
dat1
dat0 %*% betas$Betas
dat1 <- sample_n(dat0, 10)
dat1 %*% betas$Betas
dat1 <- as.matrix(dat1)
dat1
as.matrix(sapply(dat1, as.numeric))
as.matrix(lapply(dat1, as.numeric))
as.matrix(apply(dat1, as.numeric))
as.matrix(tapply(dat1, as.numeric))
as.matrix(sapplyd(dat1, as.numeric))
as.matrix(applyd(dat1, as.numeric))
as.matrix(apply(dat1, as.numeric))
betas
data.frame(mapply(`*`,dat1,betas$Betas))
as.matrix(mapply(dat1, as.numeric))
data.matrix(dat1,  rownames.force = NA)
matrix(data = dat1,  nrow = 10, ncol = dim(dat1)[2])
dat_m <- matrix(data = dat1,  nrow = dim(dat1)[1], ncol = dim(dat1)[2])
dat_m %*% betas$Betas
L
t(L) %*% dat_m
t(L)
t(L)%*% betas$Betas
new_beta <- t(L)%*% betas$Betas
new_beta <- t(L)%*% betas$Betas + betas$Betas
new_beta
betas$Names
new_beta_price < - new_beta[2]
new_beta
new_beta[2,]
new_beta_price < - new_beta[2,]
new_beta_price <- new_beta[2,]
sd
normals <- rnorm(10000, 0, 1)
new_beta_price <- exp(new_beta[2,]*normals + sd$sd[2] )
new_beta_price
normals <- rnorm(10, 0, 1)
new_beta_price <- exp(new_beta[2,]*normals + sd$sd[2] )
new_beta_price
normals <- rnorm(1, 0, 1)
new_beta_price <- exp(new_beta[2,]*normals + sd$sd[2] )
new_beta_price
new_beta_price <- exp(new_beta[2,] + sd$sd[2] * normals)
new_beta_price
new_beta2 <- c(new_beta_wld,0,0,0,new_beta[5:18])
new_beta_wld <- exp (new_beta[1,] + sd$sd[1] * normals)
new_beta_cc <- exp (new_beta[3,]  + sd$sd[3] * normals)
new_beta_nm <- exp (new_beta[4,] + sd$sd[4] * normals)
new_beta2 <- c(new_beta_wld,0,0,0,new_beta[5:18])
new_beta2
new_beta2 <- c(new_beta_wld,0,0,0,new_beta[5:19])
dat_m %*% new_beta2/ new_beta_price
wta_wetland <- mean(- dat_m %*% new_beta2/ new_beta_price)
wta_wetland
new_beta2_nm <- c(0,0,0,new_beta_nm,new_beta[5:19])
wta_nm <- mean(- dat_m %*% new_beta2_nm/ new_beta_price)
wta_nm
new_beta2_cc <- c(0,0,new_beta_cc,0,new_beta[5:19])
wta_cc <- mean(- dat_m %*% new_beta2_cc/ new_beta_price)
wta_cc
new_beta[3,]
new_beta_cc
new_beta_price
normals <- rnorm(10, 0, 1)
new_beta_price <- exp(new_beta[2,] + sd$sd[2] * normals)
new_beta_price
new_beta_wld <- exp (new_beta[1,] + sd$sd[1] * normals)
new_beta_cc <- exp (new_beta[3,]  + sd$sd[3] * normals)
new_beta_nm <- exp (new_beta[4,] + sd$sd[4] * normals)
normals <- rnorm(1, 0, 1)
new_beta_price <- exp(new_beta[2,] + sd$sd[2] * normals)
new_beta_price
new_beta_wld <- exp (new_beta[1,] + sd$sd[1] * normals)
new_beta_cc <- exp (new_beta[3,]  + sd$sd[3] * normals)
new_beta_nm <- exp (new_beta[4,] + sd$sd[4] * normals)
new_beta2_wld <- c(new_beta_wld,0,0,0,new_beta[5:19])
new_beta2_wld
wta_wetland <- mean(- dat_m %*% new_beta2_wld/ new_beta_price)
wta_wetland
new_beta2_nm <- c(0,0,0,new_beta_nm,new_beta[5:19])
wta_nm <- mean(- dat_m %*% new_beta2_nm/ new_beta_price)
wta_nm
new_beta2_cc <- c(0,0,new_beta_cc,0,new_beta[5:19])
wta_cc <- mean(- dat_m %*% new_beta2_cc/ new_beta_price)
wta_cc
dat1 <- sample_n(dat0, 100)
dat_m <- matrix(data = dat1,  nrow = dim(dat1)[1], ncol = dim(dat1)[2])
dat_m %*% betas$Betas
dat_m
rm(list = ls())
library(mlogit)
library(gmnl)
library(tidyverse)
library(fastDummies)
setwd("C:/Users/langzx/Desktop/github/DCM/data")
dataset <- read.csv (file = "wta_observables11192018.csv",header = TRUE)
dim(dataset)
n <- dim(dataset)[1]
dataset$asc <- rep(1,n )
colnames(dataset)
betas <- read.table("beta.dat", sep = ",", header = TRUE)
varcov <- read.table("varcov.dat", sep = "\t", header = FALSE)
L <- t(chol(varcov))
L
sd <- read.table("sd.dat", sep = ",", header = TRUE)
betas$Names
sd
set.seed(123)
dat0 <- select (dataset, Wetland, Payment, Covercrop, NuMgt, asc,
dem_2018,taxcost,
income_1, income_2, income_3, income_4, income_5, income_6,
areaf_1, areaf_2, areaf_3, areaf_4, crp2018, implakes )
dat1 <- sample_n(dat0, 100)
dat1
dat_m <- matrix(data = dat1,  nrow = dim(dat1)[1], ncol = dim(dat1)[2])
dat_m
dat1
dat_m <- matrix(data = dat1)
dat_m
dat_m <- matrix(data = dat1, nrow = 100, ncol = 19)
dat_m
dat_m <- as.matrix(data = dat1, nrow = 100, ncol = 19)
dat_m <- as.matrix(x = dat1, nrow = 100, ncol = 19)
dat_m
dat_m %*% betas$Betas
new_beta <- t(L)%*% betas$Betas + betas$Betas
new_beta[3,]
normals <- rnorm(1, 0, 1)
new_beta_price <- exp(new_beta[2,] + sd$sd[2] * normals)
new_beta_price
new_beta_wld <- exp (new_beta[1,] + sd$sd[1] * normals)
new_beta_cc <- exp (new_beta[3,]  + sd$sd[3] * normals)
new_beta_nm <- exp (new_beta[4,] + sd$sd[4] * normals)
new_beta2_wld <- c(new_beta_wld,0,0,0,new_beta[5:19])
new_beta2_wld
wta_wetland <- mean(- dat_m %*% new_beta2_wld/ new_beta_price)
wta_wetland
new_beta2_nm <- c(0,0,0,new_beta_nm,new_beta[5:19])
wta_nm <- mean(- dat_m %*% new_beta2_nm/ new_beta_price)
wta_nm
new_beta2_cc <- c(0,0,new_beta_cc,0,new_beta[5:19])
wta_cc <- mean(- dat_m %*% new_beta2_cc/ new_beta_price)
wta_cc
wta_cc <- - dat_m %*% new_beta2_cc/ new_beta_price
wta_cc
wta_wetland <- mean(- dat_m %*% new_beta2_wld/ new_beta_price,na.rm=TRUE)
wta_wetland
new_beta2_nm <- c(0,0,0,new_beta_nm,new_beta[5:19])
wta_nm <- mean(- dat_m %*% new_beta2_nm/ new_beta_price,na.rm=TRUE)
wta_nm
new_beta2_cc <- c(0,0,new_beta_cc,0,new_beta[5:19])
wta_cc <- mean(- dat_m %*% new_beta2_cc/ new_beta_price,na.rm=TRUE)
wta_cc
dat1 <- sample_n(dat0, 1000)
dat1
dat_m <- as.matrix(x = dat1, nrow = 1000, ncol = 19)
dat_m
dat_m %*% betas$Betas
new_beta <- t(L)%*% betas$Betas + betas$Betas
new_beta[3,]
normals <- rnorm(1, 0, 1)
new_beta_price <- exp(new_beta[2,] + sd$sd[2] * normals)
new_beta_price
new_beta_wld <- exp (new_beta[1,] + sd$sd[1] * normals)
new_beta_cc <- exp (new_beta[3,]  + sd$sd[3] * normals)
new_beta_nm <- exp (new_beta[4,] + sd$sd[4] * normals)
new_beta2_wld <- c(new_beta_wld,0,0,0,new_beta[5:19])
new_beta2_wld
wta_wetland <- mean(- dat_m %*% new_beta2_wld/ new_beta_price,na.rm=TRUE)
wta_wetland
new_beta2_nm <- c(0,0,0,new_beta_nm,new_beta[5:19])
wta_nm <- mean(- dat_m %*% new_beta2_nm/ new_beta_price,na.rm=TRUE)
wta_nm
new_beta2_cc <- c(0,0,new_beta_cc,0,new_beta[5:19])
wta_cc <- mean(- dat_m %*% new_beta2_cc/ new_beta_price,na.rm=TRUE)
wta_cc
rm(list = ls())
library(mlogit)
library(gmnl)
library(tidyverse)
library(fastDummies)
setwd("C:/Users/langzx/Desktop/github/DCM/data")
dataset <- read.csv (file = "wta_observables11192018.csv",header = TRUE)
dim(dataset)
n <- dim(dataset)[1]
dataset$asc <- rep(1,n )
colnames(dataset)
betas <- read.table("beta.dat", sep = ",", header = TRUE)
varcov <- read.table("varcov.dat", sep = "\t", header = FALSE)
L <- t(chol(varcov))
L
sd <- read.table("sd.dat", sep = ",", header = TRUE)
betas$Names
sd
dat0 <- select (dataset, Wetland, Payment, Covercrop, NuMgt, asc,
dem_2018,taxcost,
income_1, income_2, income_3, income_4, income_5, income_6,
areaf_1, areaf_2, areaf_3, areaf_4, crp2018, implakes )
dat1 <- sample_n(dat0, 1000)
dat1
dat_m <- as.matrix(x = dat1, nrow = 1000, ncol = 19)
dat_m
dat_m %*% betas$Betas
new_beta <- t(L)%*% betas$Betas + betas$Betas
new_beta[3,]
normals <- rnorm(1, 0, 1)
new_beta_price <- exp(new_beta[2,] + sd$sd[2] * normals)
new_beta_price
new_beta_wld <- exp (new_beta[1,] + sd$sd[1] * normals)
new_beta_cc <- exp (new_beta[3,]  + sd$sd[3] * normals)
new_beta_nm <- exp (new_beta[4,] + sd$sd[4] * normals)
new_beta2_wld <- c(new_beta_wld,0,0,0,new_beta[5:19])
new_beta2_wld
wta_wetland <- mean(- dat_m %*% new_beta2_wld/ new_beta_price,na.rm=TRUE)
wta_wetland
new_beta2_nm <- c(0,0,0,new_beta_nm,new_beta[5:19])
wta_nm <- mean(- dat_m %*% new_beta2_nm/ new_beta_price,na.rm=TRUE)
wta_nm
new_beta2_cc <- c(0,0,new_beta_cc,0,new_beta[5:19])
wta_cc <- mean(- dat_m %*% new_beta2_cc/ new_beta_price,na.rm=TRUE)
wta_cc
new_beta[1,]
new_beta[3,]
new_beta_cc
new_beta_nm
new_beta_wld
wta_wetland <- -sum(new_beta2_wld,na.rm=TRUE)/ new_beta_price
wta_wetland
new_beta2_wld
new_beta_price
wta_wetland <- sum(new_beta2_wld,na.rm=TRUE)/ new_beta_price
wta_wetland
normals <- rnorm(10, 0, 1)
new_beta2_wld <- c(0,0,0,0,new_beta[5:19])
new_beta2_wld
wta_wetland <- mean(-((exp (new_beta[1,] + sd$sd[1] * normals)) + dat_m %*% new_beta2_wld)/ new_beta_price,na.rm=TRUE)
wta_wetland
wta_nm <- mean(-((exp (new_beta[4,] + sd$sd[4] * normals)) + dat_m %*% new_beta2_wld)/ new_beta_price,na.rm=TRUE)
wta_nm
wta_nm <- mean(-((exp (new_beta[4,] + sd$sd[4] * normals)) + dat_m %*% new_beta2_wld)/ new_beta_price,na.rm=TRUE)
wta_nm
wta_cc <- mean(-((exp (new_beta[3,] + sd$sd[3] * normals)) + dat_m %*% new_beta2_wld)/ new_beta_price,na.rm=TRUE)
wta_cc
new_beta2 <- c(0,0,0,0,new_beta[5:19])
#new_beta2_wld <- c(0,0,0,0,new_beta[5:19])
#new_beta2_wld
wta_wetland <- mean(-((exp (new_beta[1,] + sd$sd[1] * normals)) + dat_m %*% new_beta2)/ new_beta_price,na.rm=TRUE)
wta_wetland
#new_beta2_wld <- c(0,0,0,0,new_beta[5:19])
#new_beta2_wld
wta_wetland <- -((exp (new_beta[1,] + sd$sd[1] * normals)) + dat_m %*% new_beta2)/ new_beta_price,na.rm=TRUE
#new_beta2_wld <- c(0,0,0,0,new_beta[5:19])
#new_beta2_wld
wta_wetland <- -((exp (new_beta[1,] + sd$sd[1] * normals)) + dat_m %*% new_beta2)/ new_beta_price
wta_wetland
plot(density(wta_wetland))
plot(density(wta_wetland),na.rm = TRUE)
plot(density(!.na(wta_wetland)))
plot(density(!is.na(wta_wetland)))
!is.na(wta_wetland)
plot(density(DropNA(wta_wetland)))
plot(density(dropna(wta_wetland)))
plot(density(drop_na(wta_wetland)))
wta_wetland
plot(density(na.omit(wta_wetland)))
wta_nm <- -((exp (new_beta[4,] + sd$sd[4] * normals)) + dat_m %*% new_beta2_wld)/ new_beta_price
plot(density(na.omit(wta_nm)))
wta_cc <- -((exp (new_beta[3,] + sd$sd[3] * normals)) + dat_m %*% new_beta2_wld)/ new_beta_price
plot(density(na.omit(wta_cc)))
