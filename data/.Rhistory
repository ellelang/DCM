rm(list = ls())
setwd("C:/Users/langzx/Desktop/github/DCM/data")
library(mlogit)
library(gmnl)
library(tidyverse)
library(fastDummies)
dataset <- read.csv (file = "wholeCEscio_dataset_envinfo_1119.csv",header = TRUE)
dim(dataset)
datasetcategories <- read.csv (file = "categoricaldata.csv",header = TRUE)
colnames(datasetcategories)
rm(list = ls())
setwd("C:/Users/langzx/Desktop/github/DCM/data")
library(mlogit)
library(gmnl)
library(tidyverse)
library(fastDummies)
dataset <- read.csv (file = "wholeCEscio_dataset_envinfo_1119.csv",header = TRUE)
dim(dataset)
datasetcategories <- read.csv (file = "categoricaldata.csv",header = TRUE)
colnames(datasetcategories)
dataset$alti <- ifelse(dataset$Alternatives == "V",1,2)
dataset$task <- dataset$ChoiceSet
dataset$ChoiceSet <- 2
names(dataset)
export_test_nlogit <- select(dataset, c("id","Y","ChoiceSet","alti", "task",
"Wetland","Payment","Covercrop","NuMgt",
"incomefromfarming", "landarea", "dem_president_2016", "dem_2018",
"unemploymentrate", "Yearly.Cost", "Hourly.Wage", "av_monthly_Taxes",
"cashrental_peracre", "landvalue_peracre",
"Stream_miles", "Lake_acres", "Wetland_acres",
"total_impaired", "water_impaired"))
colnames(datasetcategories)
rm(list = ls())
setwd("C:/Users/langzx/Desktop/github/DCM/data")
library(mlogit)
library(gmnl)
library(tidyverse)
library(fastDummies)
dataset <- read.csv (file = "wholeCEscio_dataset_envinfo_1119.csv",header = TRUE)
dim(dataset)
datasetcategories <- read.csv (file = "categoricaldata.csv",header = TRUE)
colnames(datasetcategories)
dataset$alti <- ifelse(dataset$Alternatives == "V",1,2)
dataset$task <- dataset$ChoiceSet
dataset$ChoiceSet <- 2
names(dataset)
export_test_nlogit <- select(dataset, c("id","Y","ChoiceSet","alti", "task",
"Wetland","Payment","Covercrop","NuMgt",
"incomefromfarming", "landarea", "dem_president_2016", "dem_2018",
"unemploymentrate", "Yearly.Cost", "Hourly.Wage", "av_monthly_Taxes",
"cashrental_peracre", "landvalue_peracre",
"Stream_miles", "Lake_acres", "Wetland_acres",
"total_impaired", "water_impaired"))
export_test_nlogit %>% left_join(datasetcategories, by = "id")
export_test_nlogit0 <- select(dataset, c("id","Y","ChoiceSet","alti", "task",
"Wetland","Payment","Covercrop","NuMgt",
"incomefromfarming", "landarea", "dem_president_2016", "dem_2018",
"unemploymentrate", "Yearly.Cost", "Hourly.Wage", "av_monthly_Taxes",
"cashrental_peracre", "landvalue_peracre",
"Stream_miles", "Lake_acres", "Wetland_acres",
"total_impaired", "water_impaired"))
export_test_nlogit <- export_test_nlogit0 %>% left_join(datasetcategories, by = "id")
dim(export_test_nlogit)
write.csv(export_test_nlogit,file = "export_test_nlogit.csv", row.names = FALSE)
dim(dataset)
write.csv(export_test_nlogit,file = "export_test_nlogit.csv", row.names = FALSE)
rm(list = ls())
setwd("C:/Users/langzx/Desktop/github/DCM/data")
library(mlogit)
library(gmnl)
library(tidyverse)
library(fastDummies)
dataset <- read.csv (file = "wholeCEscio_dataset_envinfo_1119.csv",header = TRUE)
dim(dataset)
dataset$alti <- ifelse(dataset$Alternatives == "V",1,2)
dataset$task <- dataset$ChoiceSet
dataset$ChoiceSet <- 2
names(dataset)
dataset <- fastDummies::dummy_cols(dataset, select_columns = c("incomefromfarming","landarea"))
export_test_nlogit <- select(dataset, c("id","Y","ChoiceSet","alti", "task",
"Wetland","Payment","Covercrop","NuMgt",
"incomefromfarming", "landarea", "dem_president_2016", "dem_2018",
"unemploymentrate", "Yearly.Cost", "Hourly.Wage", "av_monthly_Taxes",
"cashrental_peracre", "landvalue_peracre",
"Stream_miles", "Lake_acres", "Wetland_acres",
"total_impaired", "water_impaired"))
library(bestglm)
install.packages("bestglm")
library(bestglm)
databestglm <- filter(export_test_nlogit, export_test_nlogit$alti == 1)
databestglm$CClakeInter <- databestglm$Covercrop * databestglm$Lake_acres
databestglm <- rename(databestglm , y = Y)
databestglm <- select(databestglm,-ChoiceSet,-id,-alti,-task)
databestglm <- drop_na(databestglm)
glm_data <- as.data.frame(databestglm)
bestglm(glm_data, IC = "BIC")
#BIC agrees with backward stepwise approach
full_model<-glm(y ~ ., data = glm_data, family = binomial)
intercept_model <- glm(y ~ 1, data = glm_data)
step(out, direction = "both", k=log(nrow(glm_data)))
stepAIC(full_model, direction = "backward")
stepAIC(intercept_model, direction = "forward",scope = list(upper = full_model,lower = intercept_model))
stepAIC(intercept_model, direction = "both",scope = list(upper = full_model,lower = intercept_model))
sel_glm1 <- glm(y ~ dem_2018 + Payment + Wetland + landarea, data = glm_data)
summary(sel_glm1)
datasetcategories <- read.csv (file = "categoricaldata.csv",header = TRUE)
colnames(datasetcategories)
export_test_nlogit <- export_test_nlogit %>% left_join(datasetcategories, by = "id")
set.seed(123)
normals <- rnorm(10000, 0, 1)
plot(density(normals))
beta_price <- exp(-6.41375 + 2.96762 * normals)
mean(beta_price) # Why is it so different than the theoretical expected value?
theoretical_mean <- exp(-6.41375 + 2.96762^2 / 2)
plot(density(beta_price))
beta_wetlands <- - exp(-1.35251 + 3.00529 * normals)
mWTA_wetlands <- - beta_wetlands / beta_price
plot(density(mWTA_wetlands))
beta_CC <- (-0.34960 + 0.06189*1.837) + 1.29781 * normals
plot(density(beta_CC))
mWTA_CC <- - beta_CC / beta_price
plot(density(mWTA_CC))
density(mWTA_CC)
lognormals <- exp(normals)
