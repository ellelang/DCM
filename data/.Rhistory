rm(list = ls())
library(tidyverse)
setwd("C:/Users/langzx/Desktop/github/DCM/data")
dataset0 <- read.csv(file = "wholeCEscio_dataset_envinfo_1119.csv", header = TRUE)
dataset0$num_rotation <- as.numeric(dataset$primaryrotation)
dataset0$convCS <- ifelse(dataset$num_rotation == 1 | dataset$num_rotation == 2, 1, 0)
dataset0$corn <- ifelse(dataset$num_rotation == 1 | dataset$num_rotation == 2
| dataset$num_rotation == 4 | dataset$num_rotation == 5
| dataset$num_rotation == 9, 1, 0)
dataset <- read.csv(file = "wholeCEscio_dataset_envinfo_1119.csv", header = TRUE)
dataset$num_rotation <- as.numeric(dataset$primaryrotation)
dataset$convCS <- ifelse(dataset0$num_rotation == 1 | dataset$num_rotation == 2, 1, 0)
dataset$corn <- ifelse(dataset$num_rotation == 1 | dataset$num_rotation == 2
| dataset$num_rotation == 4 | dataset$num_rotation == 5
| dataset$num_rotation == 9, 1, 0)
dataset <- plyr::rename(dataset, c("cashrental_peracre" = "cashrent" ,"crp2018" = "crp2018", "dem_president_2016" = "demPrez16",
"incomefromfarming" = "incfar" ,"unemploymentrate" = "unemploy",
"Yearly.Cost" = "costlive", "Hourly.Wage" = "hrwage", "av_monthly_Child.Care" = "childcar",
"av_monthly_Food" = "foodcost", "av_montly_Health.Care" = "healthc",
"av_monthly_Housing" = "housecos", "av_monthly_Transport" = "transpor",
"av_monthly_Other" = "othercos", "av_monthly_Taxes" = "taxcost",
"landvalue_peracre" = "landvalu", "Stream_miles" = "impstrea",
"Lake_acres" = "implakes", "Wetland_acres" = "impwetl", "total_impaired" = "imptotal",
"landarea" = "areaf"))
export_test_nlogit <- dplyr::select(dataset, c("id","Y","ChoiceSet","alti", "task",
"Wetland","Payment","Covercrop","NuMgt",
"income", "areaf", "demPrez16", "dem_2018",
"unemploy", "costlive", "hrwage", "taxcost",
"cashrent","crp2018", "landvalu",
"impstrea", "implakes", "impwetl",
"imptotal", "childcar", "foodcost", "healthc",  "housecos",
"othercos", "convCS", "corn"))
dataset_variables <- dplyr::select(dataset, c("id","Y","ChoiceSet",
"Wetland","Payment","Covercrop","NuMgt",
"income", "areaf", "demPrez16", "dem_2018",
"unemploy", "costlive", "hrwage", "taxcost",
"cashrent","crp2018", "landvalu",
"impstrea", "implakes", "impwetl",
"imptotal", "childcar", "foodcost", "healthc",  "housecos",
"othercos", "convCS", "corn"))
dataset$convCS <- ifelse(dataset0$num_rotation == 1 | dataset$num_rotation == 2, 1, 0)
rm(list = ls())
library(tidyverse)
setwd("C:/Users/langzx/Desktop/github/DCM/data")
dataset <- read.csv(file = "wholeCEscio_dataset_envinfo_1119.csv", header = TRUE)
dataset$num_rotation <- as.numeric(dataset$primaryrotation)
dataset$convCS <- ifelse(dataset0$num_rotation == 1 | dataset$num_rotation == 2, 1, 0)
dataset$corn <- ifelse(dataset$num_rotation == 1 | dataset$num_rotation == 2
| dataset$num_rotation == 4 | dataset$num_rotation == 5
| dataset$num_rotation == 9, 1, 0)
rm(list = ls())
library(tidyverse)
setwd("C:/Users/langzx/Desktop/github/DCM/data")
dataset <- read.csv(file = "wholeCEscio_dataset_envinfo_1119.csv", header = TRUE)
dataset$num_rotation <- as.numeric(dataset$primaryrotation)
dataset$convCS <- ifelse(dataset$num_rotation == 1 | dataset$num_rotation == 2, 1, 0)
dataset$corn <- ifelse(dataset$num_rotation == 1 | dataset$num_rotation == 2
| dataset$num_rotation == 4 | dataset$num_rotation == 5
| dataset$num_rotation == 9, 1, 0)
dataset <- plyr::rename(dataset, c("cashrental_peracre" = "cashrent" ,"crp2018" = "crp2018", "dem_president_2016" = "demPrez16",
"incomefromfarming" = "incfar" ,"unemploymentrate" = "unemploy",
"Yearly.Cost" = "costlive", "Hourly.Wage" = "hrwage", "av_monthly_Child.Care" = "childcar",
"av_monthly_Food" = "foodcost", "av_montly_Health.Care" = "healthc",
"av_monthly_Housing" = "housecos", "av_monthly_Transport" = "transpor",
"av_monthly_Other" = "othercos", "av_monthly_Taxes" = "taxcost",
"landvalue_peracre" = "landvalu", "Stream_miles" = "impstrea",
"Lake_acres" = "implakes", "Wetland_acres" = "impwetl", "total_impaired" = "imptotal",
"landarea" = "areaf"))
# to be incorporated and imported into Nlogit
dataset_variables <- dplyr::select(dataset, c("id","Y","ChoiceSet",
"Wetland","Payment","Covercrop","NuMgt",
"income", "areaf", "demPrez16", "dem_2018",
"unemploy", "costlive", "hrwage", "taxcost",
"cashrent","crp2018", "landvalu",
"impstrea", "implakes", "impwetl",
"imptotal", "childcar", "foodcost", "healthc",  "housecos",
"othercos", "convCS", "corn"))
dataset$alti <- ifelse(dataset$Alternatives == "V",1,2)
dataset$task <- dataset$ChoiceSet
dataset$ChoiceSet <- 2
ataset_variables <- dplyr::select(dataset, c("id","Y","ChoiceSet","alti", "task",
"Wetland","Payment","Covercrop","NuMgt",
"income", "areaf", "demPrez16", "dem_2018",
"unemploy", "costlive", "hrwage", "taxcost",
"cashrent","crp2018", "landvalu",
"impstrea", "implakes", "impwetl",
"imptotal", "childcar", "foodcost", "healthc",  "housecos",
"othercos", "convCS", "corn"))
dataset_variables <- dplyr::select(dataset, c("id","Y","ChoiceSet","alti", "task",
"Wetland","Payment","Covercrop","NuMgt",
"income", "areaf", "demPrez16", "dem_2018",
"unemploy", "costlive", "hrwage", "taxcost",
"cashrent","crp2018", "landvalu",
"impstrea", "implakes", "impwetl",
"imptotal", "childcar", "foodcost", "healthc",  "housecos",
"othercos", "convCS", "corn"))
library(mlogit)
dataset <- read.csv(file = "wholeCEscio_dataset_envinfo_1119.csv", header = TRUE)
colnames(dataset)
dim(dataset)
dim(dataset_variables)
dataset1 <- mlogit.data(dataset_variables, varying = 6:31, shape = "long",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
head(dataset1)
datawide <- reshape(dataset1, idvar = "id", timevar = "task", direction = "wide")
datawide
dataset1 <- mlogit.data(dataset_variables[,1:9], varying = 6:9, shape = "long",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
head(dataset1)
datawide <- reshape(dataset1, idvar = "id", timevar = "task", direction = "wide")
datawide
head(dataset1)
head(dataset1)
datawide <- reshape(dataset1, idvar = "task", timevar = "alti", direction = "wide")
datawide
head(datawide,20)
dim(dataset_variables)
dataset1 <- mlogit.data(dataset_variables[,1:9], varying = 6:9, shape = "wide",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
dataset1 <- mlogit.data(dataset_variables[,1:9], varying = 6:9, shape = "wide",id.var = "id",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
datawide
dim(dataset_variables)
head(dataset_variables)
dataset1 <- reshape(dataset_variables[,1:9], varying = 6:9, shape = "long",id.var = "id",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
dataset1 <- reshape(dataset_variables[,1:9], varying = 6:9, shape = "long",id.var = "id",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
dataset1 <- mlogit.data(dataset_variables[,1:9], shape = "long",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
head(dataset1)
spread(dataset1, key = c(id,task), value = c(Wetland, payment,Covercrop, NuMgt))
spread(dataset1, key = c(id,task))
spread(dataset1, key = task)
spread(dataset1, key = task, value = id)
datasetwide1 <- reshape(dataset[1:16,], idvar = "id", timevar = "task", direction = "wide")
datasetwide1 <- reshape(dataset1[1:16,], idvar = "id", timevar = "task", direction = "wide")
datasetwide1
datasetwide1 <- reshape(dataset1[1:16,], idvar = "task", timevar = "id", direction = "wide")
datasetwide1
dataset1 <- mlogit.data(dataset_variables[,1:9], shape = "long",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
head(dataset1)
dataset[,c(1,5:9)]
dataset1[,c(1,5:9)]
setwd("D:/OneDrive/Farm survey/flipChoiceexample")
library(dplyr)
d <- read.csv(file = "CEchoiceset.csv", header = TRUE)
# Voluntary option  odd rows
v_data <- d %>% filter(row_number() %% 2 == 1)
v_data
# Current option even rows
c_data <- d %>% filter(row_number() %% 2 == 0)
c_data
nn_v<-reshape(v_data,timevar="ChoiceSet",idvar="Alternatives",direction="wide")[,-1]
nn_v
nn_v <- nn_v  %>%  select(starts_with("Wetland."), starts_with("Covercrop."), starts_with("NuMgt"),starts_with("Payment"))
nn_v
nn_c<-reshape(c_data,timevar="ChoiceSet",idvar="Alternatives",direction="wide")[,-1]
nn_c
nn_c <- nn_c  %>%  select(starts_with("Wetland."), starts_with("Covercrop."), starts_with("NuMgt"),starts_with("Payment"))
nn_c
dataset1 <- mlogit.data(dataset_variables[,1:9], shape = "long",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
datasetwide1 <- reshape(dataset1, idvar = "task", timevar = "alti", direction = "wide")
datasetwide1
head(dataset1)
head(dataset1)
dataset1 <- mlogit.data(dataset_variables[,1:9], shape = "long",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
head(dataset1)
datasetwide1 <- reshape(dataset1, idvar = "task", timevar = "alti", direction = "wide")
datasetwide1
head(datasetwide1)
datasetwide1$Choice <- ifelse(datasetwide1$Y.1 == TRUE, 1, 2)
datasetwide1$Choice
head(datasetwide1)
datasetwide1[,c(2,5:8,11:16)]
head(datasetwide1)
datasetwide1[,c(2,5:8,12:16)]
left_join(datasetwide1[,c(2,5:8,12:16)],dataset_variables,by = c("id.1","id"))
left_join(datasetwide1[,c(2,5:8,12:16)],dataset_variables,by = c(x= "id.1",y = "id"))
datasetwide <- left_join(datasetwide1[,c(2,5:8,12:16)],dataset_variables, by.x = "id.1", by.y = "id")
datasetwide <- left_join(datasetwide1,dataset_variables, by.x = "id.1", by.y = "id")
datasetwide1[,c(2,5:8,12:16)]
datasetwide <- left_join(datasetwide1,dataset_variables, by = c("id.1" = "id"))
datasetwide1 <- reshape(dataset1, idvar = "task", timevar = "alti", direction = "wide")
datasetwide1
head(datasetwide1)
datasetwide1$Choice <- ifelse(datasetwide1$Y.1 == TRUE, 1, 2)
datasetwide1$Choice
head(datasetwide1)
datasetwide1[,c(2,5:8,12:16)]
datasetwide <- left_join(datasetwide1[,c(2,5:8,12:16)],dataset_variables, by = c("id.1" = "id"))
datasetwide
rm(list = ls())
library(mlogit)
library(tidyverse)
setwd("C:/Users/langzx/Desktop/github/DCM/data")
dataset <- read.csv(file = "wholeCEscio_dataset_envinfo_1119.csv", header = TRUE)
colnames(dataset)
dim(dataset)
dataset$alti <- ifelse(dataset$Alternatives == "V",1,2)
dataset$task <- dataset$ChoiceSet
dataset$ChoiceSet <- 2
dataset$num_rotation <- as.numeric(dataset$primaryrotation)
dataset$convCS <- ifelse(dataset$num_rotation == 1 | dataset$num_rotation == 2, 1, 0)
dataset$corn <- ifelse(dataset$num_rotation == 1 | dataset$num_rotation == 2
| dataset$num_rotation == 4 | dataset$num_rotation == 5
| dataset$num_rotation == 9, 1, 0)
dataset <- plyr::rename(dataset, c("cashrental_peracre" = "cashrent" ,"crp2018" = "crp2018", "dem_president_2016" = "demPrez16",
"incomefromfarming" = "incfar" ,"unemploymentrate" = "unemploy",
"Yearly.Cost" = "costlive", "Hourly.Wage" = "hrwage", "av_monthly_Child.Care" = "childcar",
"av_monthly_Food" = "foodcost", "av_montly_Health.Care" = "healthc",
"av_monthly_Housing" = "housecos", "av_monthly_Transport" = "transpor",
"av_monthly_Other" = "othercos", "av_monthly_Taxes" = "taxcost",
"landvalue_peracre" = "landvalu", "Stream_miles" = "impstrea",
"Lake_acres" = "implakes", "Wetland_acres" = "impwetl", "total_impaired" = "imptotal",
"landarea" = "areaf"))
# note: should make dummies for farm size categories, farm income and others
# to be incorporated and imported into Nlogit
dataset_variables <- dplyr::select(dataset, c("id","Y","ChoiceSet","alti", "task",
"Wetland","Payment","Covercrop","NuMgt",
"income", "areaf", "demPrez16", "dem_2018",
"unemploy", "costlive", "hrwage", "taxcost",
"cashrent","crp2018", "landvalu",
"impstrea", "implakes", "impwetl",
"imptotal", "childcar", "foodcost", "healthc",  "housecos",
"othercos", "convCS", "corn"))
dim(dataset_variables)
head(dataset_variables)
dataset1 <- mlogit.data(dataset_variables[,1:9], shape = "long",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
head(dataset1)
datasetwide1 <- reshape(dataset1, idvar = "task", timevar = "alti", direction = "wide")
datasetwide1
dim(datasetwide1)
datasetwide1 <- reshape(dataset1, idvar = c("id","task"), timevar = "alti", direction = "wide")
dim(datasetwide1)
dataset1 <- mlogit.data(dataset_variables[,1:9], shape = "long",
choice = "Y", alt.levels = c("V", "C"), id.var = "id")
head(dataset1)
datasetwide1 <- reshape(dataset1, idvar = c("id","task"), timevar = "alti", direction = "wide")
dim(datasetwide1)
head(datasetwide1)
dim(datasetwide1)
head(datasetwide1)
head(datasetwide1,16)
datasetwide1$Choice <- ifelse(datasetwide1$Y.1 == TRUE, 1, 2)
datasetwide1$Choice
head(datasetwide1)
datasetwide1[,c(2,5:8,12:16)]
head(datasetwide1)
datasetwide <- left_join(datasetwide1[,c(2,5:8,12:16)],dataset_variables)
datasetwide <- left_join(datasetwide1,dataset_variables)
head(datasetwide1)
datasetwide <- left_join(datasetwide1,dataset_variables, by = c("id" = "id"))
datasetwide
head(datasetwide1)
datasetwide <- left_join(datasetwide1[,-2], dataset_variables, by = c("id" = "id"))
datasetwide
441*8
head(datasetwide1)
dim(datasetwide1)
datasetwide <- datasetwide1
datasetwide <- left_join(datasetwide, dataset_variables, by = c("id" = "id"))
dim(datasetwide)
datasetwide <- inner_join(datasetwide, dataset_variables, by = c("id" = "id"))
dim(datasetwide)
datasetwide <- datasetwide1
datasetwide <- inner_join(datasetwide, dataset_variables)
dim(datasetwide)
datasetwide <- datasetwide1
datasetwide <- left_join(datasetwide, dataset_variables)
dim(datasetwide)
datasetwide <- datasetwide1
datasetwide <- left_join(datasetwide, dataset_variables, by = "id")
dim(datasetwide)
datasetwide <- datasetwide1
head(datasetwide1)
datasetwide <- datasetwide1
datasetwide1 <- reshape(dataset_variables, idvar = c("id","task"), timevar = "alti", direction = "wide")
dim(datasetwide1)
rm(list = ls())
library(mlogit)
library(tidyverse)
setwd("C:/Users/langzx/Desktop/github/DCM/data")
dataset <- read.csv(file = "wholeCEscio_dataset_envinfo_1119.csv", header = TRUE)
colnames(dataset)
dim(dataset)
dataset$alti <- ifelse(dataset$Alternatives == "V",1,2)
dataset$task <- dataset$ChoiceSet
dataset$ChoiceSet <- 2
dataset$num_rotation <- as.numeric(dataset$primaryrotation)
dataset$convCS <- ifelse(dataset$num_rotation == 1 | dataset$num_rotation == 2, 1, 0)
dataset$corn <- ifelse(dataset$num_rotation == 1 | dataset$num_rotation == 2
| dataset$num_rotation == 4 | dataset$num_rotation == 5
| dataset$num_rotation == 9, 1, 0)
dataset <- plyr::rename(dataset, c("cashrental_peracre" = "cashrent" ,"crp2018" = "crp2018", "dem_president_2016" = "demPrez16",
"incomefromfarming" = "incfar" ,"unemploymentrate" = "unemploy",
"Yearly.Cost" = "costlive", "Hourly.Wage" = "hrwage", "av_monthly_Child.Care" = "childcar",
"av_monthly_Food" = "foodcost", "av_montly_Health.Care" = "healthc",
"av_monthly_Housing" = "housecos", "av_monthly_Transport" = "transpor",
"av_monthly_Other" = "othercos", "av_monthly_Taxes" = "taxcost",
"landvalue_peracre" = "landvalu", "Stream_miles" = "impstrea",
"Lake_acres" = "implakes", "Wetland_acres" = "impwetl", "total_impaired" = "imptotal",
"landarea" = "areaf"))
# note: should make dummies for farm size categories, farm income and others
# to be incorporated and imported into Nlogit
dataset_variables <- dplyr::select(dataset, c("id","Y","ChoiceSet","alti", "task",
"Wetland","Payment","Covercrop","NuMgt",
"income", "areaf", "demPrez16", "dem_2018",
"unemploy", "costlive", "hrwage", "taxcost",
"cashrent","crp2018", "landvalu",
"impstrea", "implakes", "impwetl",
"imptotal", "childcar", "foodcost", "healthc",  "housecos",
"othercos", "convCS", "corn"))
dim(dataset_variables)
head(dataset_variables)
datasetwide1 <- reshape(dataset_variables[,1:9], idvar = c("id","task"), timevar = "alti", direction = "wide")
dim(datasetwide1)
head(datasetwide1,16)
datasetwide1$Choice <- ifelse(datasetwide1$Y.1 == 1, 1, 2)
datasetwide1$Choice
head(datasetwide1)
datasetwide <- datasetwide1
datasetwide <- left_join(datasetwide, dataset_variables)
dim(datasetwide)
setwd("C:/Users/langzx/Desktop/github/DCM/data")
idinfo <- read.csv(file = "idinfo.csv",header = TRUE)
data_id <- dataset_variables[!duplicated(dataset_variables), ]
dim(data_id)
idinfo_variables <- dplyr::select(dataset, c("id",
"income", "areaf", "demPrez16", "dem_2018",
"unemploy", "costlive", "hrwage", "taxcost",
"cashrent","crp2018", "landvalu",
"impstrea", "implakes", "impwetl",
"imptotal", "childcar", "foodcost", "healthc",  "housecos",
"othercos", "convCS", "corn"))
info_id <- info_variables[!duplicated(info_variables), ]
idinfo_variables <- dplyr::select(dataset, c("id",
"income", "areaf", "demPrez16", "dem_2018",
"unemploy", "costlive", "hrwage", "taxcost",
"cashrent","crp2018", "landvalu",
"impstrea", "implakes", "impwetl",
"imptotal", "childcar", "foodcost", "healthc",  "housecos",
"othercos", "convCS", "corn"))
info_id <- idinfo_variables[!duplicated(idinfo_variables), ]
dim(data_id)
idinfo <- read.csv(file = "idinfo.csv",header = TRUE)
idinfo$num_rotation <- as.numeric(dataset$primaryrotation)
idinfo$convCS <- ifelse(dataset$num_rotation == 1 | dataset$num_rotation == 2, 1, 0)
idinfo$corn <- ifelse(dataset$num_rotation == 1 | dataset$num_rotation == 2
| dataset$num_rotation == 4 | dataset$num_rotation == 5
| dataset$num_rotation == 9, 1, 0)
idinfo$num_rotation <- as.numeric(idinfo$primaryrotation)
idinfo$convCS <- ifelse(idinfo$num_rotation == 1 | idinfo$num_rotation == 2, 1, 0)
idinfo$corn <- ifelse(idinfo$num_rotation == 1 | idinfo$num_rotation == 2
| idinfo$num_rotation == 4 | idinfo$num_rotation == 5
| idinfo$num_rotation == 9, 1, 0)
datasetidinfo <- plyr::rename(idinfo, c("cashrental_peracre" = "cashrent" ,"crp2018" = "crp2018", "dem_president_2016" = "demPrez16",
"incomefromfarming" = "incfar" ,"unemploymentrate" = "unemploy",
"Yearly.Cost" = "costlive", "Hourly.Wage" = "hrwage", "av_monthly_Child.Care" = "childcar",
"av_monthly_Food" = "foodcost", "av_montly_Health.Care" = "healthc",
"av_monthly_Housing" = "housecos", "av_monthly_Transport" = "transpor",
"av_monthly_Other" = "othercos", "av_monthly_Taxes" = "taxcost",
"landvalue_peracre" = "landvalu", "Stream_miles" = "impstrea",
"Lake_acres" = "implakes", "Wetland_acres" = "impwetl", "total_impaired" = "imptotal",
"landarea" = "areaf"))
idinfo_variables <- dplyr::select(datasetidinfo, c("id",
"income", "areaf", "demPrez16", "dem_2018",
"unemploy", "costlive", "hrwage", "taxcost",
"cashrent","crp2018", "landvalu",
"impstrea", "implakes", "impwetl",
"imptotal", "childcar", "foodcost", "healthc",  "housecos",
"othercos", "convCS", "corn"))
idinfo_variables <- dplyr::select(datasetidinfo, c("ID",
"income", "areaf", "demPrez16", "dem_2018",
"unemploy", "costlive", "hrwage", "taxcost",
"cashrent","crp2018", "landvalu",
"impstrea", "implakes", "impwetl",
"imptotal", "childcar", "foodcost", "healthc",  "housecos",
"othercos", "convCS", "corn"))
dim(idinfo_variables)
datasetwide <- left_join(datasetwide1, idinfo_variables)
datasetwide <- left_join(datasetwide1, idinfo_variables, by = c("id" = "ID"))
dim(datasetwide)
write.csv(x = datasetwide, file = "obswta_datasetwide.csv", row.names = FALSE)
write.table (x = datasetwide, file = "widedata.dat", sep = "\t",quote=FALSE, row.names = FALSE)
